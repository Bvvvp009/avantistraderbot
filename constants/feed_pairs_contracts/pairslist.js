const { Contract } = require('ethers');
const { ethers } = require('ethers');
const fs = require('fs');

const rpc = new ethers.JsonRpcProvider('https://base-mainnet.g.alchemy.com/v2/bryKu25u57tCOIaIjua3t8_no7V4_MYN');
const abi = [{"inputs":[],"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256[]","name":"pairIndex","type":"uint256[]"},{"indexed":false,"internalType":"uint256[]","name":"limits","type":"uint256[]"}],"name":"BlockOILimitsSet","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"},{"indexed":false,"internalType":"string","name":"name","type":"string"}],"name":"FeeAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"}],"name":"FeeUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"},{"indexed":false,"internalType":"string","name":"name","type":"string"}],"name":"GroupAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"}],"name":"GroupUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint8","name":"version","type":"uint8"}],"name":"Initialized","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"pairIndex","type":"uint256"},{"indexed":false,"internalType":"uint256[]","name":"tier","type":"uint256[]"},{"indexed":false,"internalType":"uint256[]","name":"multiplier","type":"uint256[]"}],"name":"LossProtectionAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256[]","name":"pairIndex","type":"uint256[]"},{"indexed":false,"internalType":"uint256[]","name":"limits","type":"uint256[]"}],"name":"OrderLimitsSet","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"},{"indexed":false,"internalType":"string","name":"from","type":"string"},{"indexed":false,"internalType":"string","name":"to","type":"string"}],"name":"PairAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"}],"name":"PairUpdated","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"}],"name":"SkewFeeAdded","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"internalType":"uint256","name":"index","type":"uint256"}],"name":"SkewFeeUpdated","type":"event"},{"inputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"openFeeP","type":"uint256"},{"internalType":"uint256","name":"closeFeeP","type":"uint256"},{"internalType":"uint256","name":"limitOrderFeeP","type":"uint256"},{"internalType":"uint256","name":"minLevPosUSDC","type":"uint256"}],"internalType":"struct IPairStorage.Fee","name":"_fee","type":"tuple"}],"name":"addFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"minLeverage","type":"uint256"},{"internalType":"uint256","name":"maxLeverage","type":"uint256"},{"internalType":"uint256","name":"maxOpenInterestP","type":"uint256"}],"internalType":"struct IPairStorage.Group","name":"_group","type":"tuple"}],"name":"addGroup","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"string","name":"from","type":"string"},{"internalType":"string","name":"to","type":"string"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"bytes32","name":"feedId","type":"bytes32"}],"internalType":"struct IPairStorage.Feed","name":"feed","type":"tuple"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"address","name":"feedId","type":"address"}],"internalType":"struct IPairStorage.BackupFeed","name":"backupFeed","type":"tuple"},{"internalType":"uint256","name":"spreadP","type":"uint256"},{"internalType":"uint256","name":"priceImpactMultiplier","type":"uint256"},{"internalType":"int256","name":"skewImpactMultiplier","type":"int256"},{"internalType":"uint256","name":"groupIndex","type":"uint256"},{"internalType":"uint256","name":"feeIndex","type":"uint256"},{"internalType":"uint256","name":"groupOpenInterestPecentage","type":"uint256"},{"internalType":"uint256","name":"maxWalletOI","type":"uint256"}],"internalType":"struct IPairStorage.Pair","name":"_pair","type":"tuple"}],"name":"addPair","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"components":[{"internalType":"int256[2][10]","name":"eqParams","type":"int256[2][10]"}],"internalType":"struct IPairStorage.SkewFee","name":"_skewFee","type":"tuple"}],"name":"addSkewOpenFees","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"blockOILimit","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"currentOrderId","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"delistPair","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"string","name":"_from","type":"string"},{"internalType":"string","name":"_to","type":"string"}],"name":"enlistPair","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"fees","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"openFeeP","type":"uint256"},{"internalType":"uint256","name":"closeFeeP","type":"uint256"},{"internalType":"uint256","name":"limitOrderFeeP","type":"uint256"},{"internalType":"uint256","name":"minLevPosUSDC","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"feesCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"getSkewParams","outputs":[{"components":[{"internalType":"int256[2][10]","name":"eqParams","type":"int256[2][10]"}],"internalType":"struct IPairStorage.SkewFee","name":"skewFee","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"groupMaxOI","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"groupOI","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"groupOIs","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"groups","outputs":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"minLeverage","type":"uint256"},{"internalType":"uint256","name":"maxLeverage","type":"uint256"},{"internalType":"uint256","name":"maxOpenInterestP","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"groupsCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"guaranteedSlEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"address","name":"_storageT","type":"address"},{"internalType":"uint256","name":"_currentOrderId","type":"uint256"}],"name":"initialize","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"isDynamicSpreadEnabled","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"}],"name":"isPairListed","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"isUSDCAligned","outputs":[{"internalType":"bool","name":"","type":"bool"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"},{"internalType":"uint256","name":"","type":"uint256"}],"name":"lossProtection","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"internalType":"uint256","name":"_tier","type":"uint256"}],"name":"lossProtectionMultiplier","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"maxWalletOI","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"internalType":"uint256","name":"_leveragePos","type":"uint256"}],"name":"openCloseThreshold","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairBackupFeed","outputs":[{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"address","name":"feedId","type":"address"}],"internalType":"struct IPairStorage.BackupFeed","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairCloseFeeP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairFeed","outputs":[{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"bytes32","name":"feedId","type":"bytes32"}],"internalType":"struct IPairStorage.Feed","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairGroupIndex","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairJob","outputs":[{"internalType":"string","name":"","type":"string"},{"internalType":"string","name":"","type":"string"},{"internalType":"bytes32","name":"","type":"bytes32"},{"internalType":"address","name":"","type":"address"},{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairLimitOrderFeeP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairMaxLeverage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairMaxOI","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairMinLevPosUSDC","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairMinLeverage","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"internalType":"uint256","name":"_leveragedPosition","type":"uint256"},{"internalType":"bool","name":"_buy","type":"bool"}],"name":"pairOpenFeeP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairPriceImpactMultiplier","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairSkewImpactMultiplier","outputs":[{"internalType":"int256","name":"","type":"int256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"}],"name":"pairSpreadP","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"","type":"uint256"}],"name":"pairs","outputs":[{"internalType":"string","name":"from","type":"string"},{"internalType":"string","name":"to","type":"string"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"bytes32","name":"feedId","type":"bytes32"}],"internalType":"struct IPairStorage.Feed","name":"feed","type":"tuple"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"address","name":"feedId","type":"address"}],"internalType":"struct IPairStorage.BackupFeed","name":"backupFeed","type":"tuple"},{"internalType":"uint256","name":"spreadP","type":"uint256"},{"internalType":"uint256","name":"priceImpactMultiplier","type":"uint256"},{"internalType":"int256","name":"skewImpactMultiplier","type":"int256"},{"internalType":"uint256","name":"groupIndex","type":"uint256"},{"internalType":"uint256","name":"feeIndex","type":"uint256"},{"internalType":"uint256","name":"groupOpenInterestPecentage","type":"uint256"},{"internalType":"uint256","name":"maxWalletOI","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_index","type":"uint256"}],"name":"pairsBackend","outputs":[{"components":[{"internalType":"string","name":"from","type":"string"},{"internalType":"string","name":"to","type":"string"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"bytes32","name":"feedId","type":"bytes32"}],"internalType":"struct IPairStorage.Feed","name":"feed","type":"tuple"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"address","name":"feedId","type":"address"}],"internalType":"struct IPairStorage.BackupFeed","name":"backupFeed","type":"tuple"},{"internalType":"uint256","name":"spreadP","type":"uint256"},{"internalType":"uint256","name":"priceImpactMultiplier","type":"uint256"},{"internalType":"int256","name":"skewImpactMultiplier","type":"int256"},{"internalType":"uint256","name":"groupIndex","type":"uint256"},{"internalType":"uint256","name":"feeIndex","type":"uint256"},{"internalType":"uint256","name":"groupOpenInterestPecentage","type":"uint256"},{"internalType":"uint256","name":"maxWalletOI","type":"uint256"}],"internalType":"struct IPairStorage.Pair","name":"","type":"tuple"},{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"minLeverage","type":"uint256"},{"internalType":"uint256","name":"maxLeverage","type":"uint256"},{"internalType":"uint256","name":"maxOpenInterestP","type":"uint256"}],"internalType":"struct IPairStorage.Group","name":"","type":"tuple"},{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"openFeeP","type":"uint256"},{"internalType":"uint256","name":"closeFeeP","type":"uint256"},{"internalType":"uint256","name":"limitOrderFeeP","type":"uint256"},{"internalType":"uint256","name":"minLevPosUSDC","type":"uint256"}],"internalType":"struct IPairStorage.Fee","name":"","type":"tuple"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"pairsCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"resetGroupOIs","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256[]","name":"_pairIndex","type":"uint256[]"},{"internalType":"uint256[]","name":"_limits","type":"uint256[]"}],"name":"setBlockOILImits","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[],"name":"skewedFeesCount","outputs":[{"internalType":"uint256","name":"","type":"uint256"}],"stateMutability":"view","type":"function"},{"inputs":[],"name":"storageT","outputs":[{"internalType":"contract ITradingStorage","name":"","type":"address"}],"stateMutability":"view","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"components":[{"internalType":"int256[2][10]","name":"eqParams","type":"int256[2][10]"}],"internalType":"struct IPairStorage.SkewFee","name":"_skewFee","type":"tuple"}],"name":"udpateSkewOpenFees","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"},{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"openFeeP","type":"uint256"},{"internalType":"uint256","name":"closeFeeP","type":"uint256"},{"internalType":"uint256","name":"limitOrderFeeP","type":"uint256"},{"internalType":"uint256","name":"minLevPosUSDC","type":"uint256"}],"internalType":"struct IPairStorage.Fee","name":"_fee","type":"tuple"}],"name":"updateFee","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_id","type":"uint256"},{"components":[{"internalType":"string","name":"name","type":"string"},{"internalType":"uint256","name":"minLeverage","type":"uint256"},{"internalType":"uint256","name":"maxLeverage","type":"uint256"},{"internalType":"uint256","name":"maxOpenInterestP","type":"uint256"}],"internalType":"struct IPairStorage.Group","name":"_group","type":"tuple"}],"name":"updateGroup","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"internalType":"uint256","name":"_amount","type":"uint256"},{"internalType":"bool","name":"_long","type":"bool"},{"internalType":"bool","name":"_increase","type":"bool"}],"name":"updateGroupOI","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"internalType":"uint256[]","name":"_tier","type":"uint256[]"},{"internalType":"uint256[]","name":"_multiplierPercent","type":"uint256[]"}],"name":"updateLossProtectionMultiplier","outputs":[],"stateMutability":"nonpayable","type":"function"},{"inputs":[{"internalType":"uint256","name":"_pairIndex","type":"uint256"},{"components":[{"internalType":"string","name":"from","type":"string"},{"internalType":"string","name":"to","type":"string"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"bytes32","name":"feedId","type":"bytes32"}],"internalType":"struct IPairStorage.Feed","name":"feed","type":"tuple"},{"components":[{"internalType":"uint256","name":"maxDeviationP","type":"uint256"},{"internalType":"address","name":"feedId","type":"address"}],"internalType":"struct IPairStorage.BackupFeed","name":"backupFeed","type":"tuple"},{"internalType":"uint256","name":"spreadP","type":"uint256"},{"internalType":"uint256","name":"priceImpactMultiplier","type":"uint256"},{"internalType":"int256","name":"skewImpactMultiplier","type":"int256"},{"internalType":"uint256","name":"groupIndex","type":"uint256"},{"internalType":"uint256","name":"feeIndex","type":"uint256"},{"internalType":"uint256","name":"groupOpenInterestPecentage","type":"uint256"},{"internalType":"uint256","name":"maxWalletOI","type":"uint256"}],"internalType":"struct IPairStorage.Pair","name":"_pair","type":"tuple"}],"name":"updatePair","outputs":[],"stateMutability":"nonpayable","type":"function"}]
const contract = new Contract("0x92Ed158d5e423CFdc9eed5Bd7328FFF7CeD6fF94", abi, rpc);

async function pairInfo() {
  const pairsInformation = [];
  const pairsIndex = {};

  try {
    for (let i = 0; i < 52; i++) {
      const pair = await contract.pairs(i);

      // Construct the "FROM/TO" format in uppercase
      const fromTo = `${pair[0].toUpperCase()}/${pair[1].toUpperCase()}`;
      const pairIndexNumber = `${i}`
      // Save the data in the required formats
      pairsInformation.push({pairIndexNumber:`${fromTo}`})
      pairsIndex[`${fromTo}`] = i;
    }

    // Write to pairsinformation.json
    fs.writeFileSync(
      './pairs/pairsinformation.json',
      JSON.stringify(pairsInformation, null, 2)
    );

    // // Write to pairsindex.json
    // fs.writeFileSync(
    //   './pairs/pairsindex.json',
    //   JSON.stringify(pairsIndex, null, 2)
    // );

    console.log("Files have been saved successfully!");
  } catch (error) {
    console.error("An error occurred:", error);
  }
}

pairInfo();
